<!DOCTYPE html><html lang="zh-cn" class="serif"><head><!-- You know, rather than reading the source like a chump, you can see it all on GitHub like a champ: https://github.com/h404bi/h404bi.com --><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="renderer" content="webkit"><meta name="generator" content="Hexo"><title>用 Scoop 改善 Windows Powershell · Chawye Hsu, h404bi</title><link rel="dns-prefetch" href="//fonts.gstatic.com"><link rel="icon" type="image/x-icon" href="/favicon.ico"><link rel="stylesheet" href="/static/type.css"></head><body><div id="site-wrapper" class="site-wrapper"><header id="site-header" class="site-header wrap"><a class="site-title" href="/">h404bi.com</a><nav class="site-nav"><ul><li><a href="/blog">Blog</a></li><li><a href="/blog/links.html">Links</a></li><li><a href="/blog/guestbook.html">Guestbook</a></li></ul></nav></header><main id="main" role="main"><div id="content" class="content wrap"><article itemscope itemtype="http://schema.org/Article"><header class="page-header"><h1 class="page-title">用 Scoop 改善 Windows Powershell</h1></header><section class="page-content"><h2>一本道</h2><p>软件包管理工具想必大家已经很清楚并且使用过。Debian/ Ubuntu 的 apt-get，Arch Linux 的 Pacman，就连本身并无自带包管理工具的 Mac 都有了 Macports 和极其好用的 Homebrew。至于 Windows 下，Geek 们也生产出各式各样的工具以贴合他们的 *nix 使用习惯。其中软件包管理工具中比较出名的就是 <strong><a href="https://chocolatey.org/" target="_blank" rel="noopener">chocolatey</a></strong> 了。</p><p>然而本文并不细谈 chocolatey，而谈的是一个叫做 <strong><a href="http://scoop.sh/" target="_blank" rel="noopener">Scoop</a></strong> 工具。官网上的描述是“A command-line installer for Windows”，其实说白了，就是和 chocolatey 同属一种东西，也就是 Windows 下的软件包管理工具，但其并没有 chocolatey 出名与强大。</p><p>那我为什么要用 Scoop 而不是 chocolatey？一正是 chocolatey 够强大，但其实我一开始并没打算折腾 Powershell，因为已经在用 Git Bash / MSYS2，所以我无需使用太过庞大的工具；二是 scoop 有吸引我的地方，它能把 Powershell 弄得看起来像 Linux shell 的样子，这也是为什么我要折腾 PS 的促因。</p><p>看 Scoop 主页的 Demo 视频，你会发现视频里的 PS 用起来很简约，而又是更方便了，不仅能安装运行各种 GNU 工具（<code>curl</code>、<code>vim</code> 等），而且 <code>$PS1</code> 看起来像是 Linux 下的终端，还能显示 git 仓库的分支信息，简直 Geek 范十足。虽说已有 MSYS2 这种更集成的 *nix 环境，但既然看到了 Scoop 又挺不错的于是就折腾下呗。毕竟是 Windows 内置的嘛，还能 Win + R powershell 快速打开，有时候打下指令（<code>ipconfig</code>、<code>nslookup</code> 什么的）还是会用到的呢。</p><figure class="center"><img src="/uploads/20150823002.png" title="配置 Scoop 后的样子"><figcaption><p>配置 Scoop 后的样子</p></figcaption></figure><h2>正题</h2><ol><li><p>确保你已安装 Powershell 3（其实 Windows7+ 应该都已经集成了），然后 WIn + R 输入 powershell 打开 PS，一句命令安装 scoop：</p><figure class="highlight ps"><table><tr><td class="code"><pre><span class="line">iex (<span class="built_in">new-object</span> net.webclient).downloadstring(<span class="string">'https://get.scoop.sh'</span>)</span><br></pre></td></tr></table></figure></li><li><p>安装完成后输入 <code>scoop help</code>，如果报错则需要允许 PS 提供脚本执行权限，执行：</p><figure class="highlight ps"><table><tr><td class="code"><pre><span class="line"><span class="built_in">set-executionpolicy</span> unrestricted -s cu</span><br></pre></td></tr></table></figure></li><li><p>然后就可以像 apt-get 那样 <code>install/uninstall</code> 软件包了：</p><figure class="highlight ps"><table><tr><td class="code"><pre><span class="line">scoop install pkgname</span><br></pre></td></tr></table></figure><p>用 scoop 安装软件包时不会弹出 UAC 要求提权，因为软件包是安装在当前用户的 <code>appdata</code> 下的，并通过 shims path 管理调用执行文件，而不是将每个执行文件的路径都加到 path 中。</p></li><li><p>开始美化控制台显示样式（★） 首先 <code>scoop install concfg</code> 安装 <code>concfg</code>，然后导入 Solarized 主题 <code>concfg import solarized small</code>（concfg 支持多种主题，详见 <a href="https://github.com/lukesampson/concfg/tree/master/presets" target="_blank" rel="noopener">concfg/presets</a>），期间会提示你替换了哪些控制台（其实也就 <code>CMD</code> 和 <code>PS</code>）的样式。 然后 <code>scoop install pshazz</code> 安装 <code>pshazz</code>，当安装完后马上就能看到 shell prompt 发生变化了，而且 cd 到一个 git 仓库还能看到分支信息，还支持 git auto-completion 呢。</p></li><li><p>然后还可以安装使用 <code>touch</code>、<code>curl</code>、<code>vim</code> 等更多的 GNU 命令行工具。scoop 官方的 Packages 是 <a href="https://github.com/lukesampson/scoop/tree/master/bucket" target="_blank" rel="noopener">bucket</a>，如果里面没有你想安装的工具你还可以<a href="https://github.com/lukesampson/scoop/wiki/Buckets#creating-your-own-bucket" target="_blank" rel="noopener">自定义 bucket</a> 或 <a href="https://github.com/lukesampson/scoop/wiki/Creating-an-app-manifest" target="_blank" rel="noopener">创建一个 package</a>。</p></li><li><p>最后还能用 scoop 进行开发语言环境的<a href="https://github.com/lukesampson/scoop/wiki/Switching-Ruby-and-Python-Versions" target="_blank" rel="noopener">多版本控制</a>呢，比如 <code>scoop install python27 python</code> 同时安装 Py2.7 和 Py3，然后 <code>scoop reset python27</code> 选择 Py2.7，<code>scoop reset python</code> 则设置为 Py3。</p></li></ol><p>至于更详尽的使用方法请 <code>scoop help</code> 或访问 <a href="https://github.com/lukesampson/scoop/wiki" target="_blank" rel="noopener">Scoop Wiki</a> 咯。</p><p>总结：所以说这种人就只能为他们的这种“如此难以伺候”而不断地折腾自己的电脑，折腾自己。这就是所谓“生命不息，折腾不止”吧哈哈哈。。。卒</p></section><section class="page-comments"><div id="load-disqus"><a href="javascript:void(0)" onclick="disqus.load()">Load disqus</a></div><div id="disqus_thread"></div></section><footer class="page-footer"></footer></article></div></main><footer id="site-footer" class="site-footer wrap"><p>&copy; 2017 h404bi, unless otherwise noted.</p></footer></div><script>!function(){var t=document.createElement("script"),s=window.location.protocol.split(":")[0];"https"===s?t.src="https://zz.bdstatic.com/linksubmit/push.js":t.src="http://push.zhanzhang.baidu.com/push.js";var e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(t,e)}();</script><script>var disqus={load:function(){var e="h404bi";!function(){var t=document.createElement("script");t.type="text/javascript",t.async=!0,t.src="//"+e+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(t)}(),document.getElementById("load-disqus").outerHTML=""}};</script><script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-91882040-1","auto"),ga("send","pageview");</script><script async src="https://www.google-analytics.com/analytics.js"></script></body></html>