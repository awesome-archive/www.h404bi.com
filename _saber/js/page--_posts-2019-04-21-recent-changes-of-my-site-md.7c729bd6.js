(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{51:function(t,e,a){"use strict";a.r(e);var r=a(0),s=function(t){var e={attributes:{slug:"recent-changes-of-my-site",layout:"post",title:"总结下博客最近的调整",keywords:"Blog,Hexo,Static Site Generator,Saber,Netlify",description:"我建博客始于 2013 年，时间也不长。那会儿也不过是一个从 WordPress 加免费空间入坑 的新手，免费空间关了就买了个域名和虚拟空间继续折腾。啊对，也改成了 Typecho 一段 时间，仿过几个主题。之后便是在流行之下换成了静态博客 Hexo。",date:"2019-04-21 18:07:40",cover:"/uploads/2019/04/20190421008.png",excerpt:'<p>我建博客始于 2013 年，时间也不长。那会儿也不过是一个从 WordPress 加免费空间入坑的新手，免费空间关了就买了个域名和虚拟空间继续折腾。啊对，也改成了 Typecho 一段时间，仿过几个主题。之后便是在流行之下，一个 <a href="https://github.com/h404bi/www.h404bi.com/commit/88362f79adfea93151ecc9f19f8647cd28562c2c" target="_blank" rel="noopener noreferrer">commit</a> 换成了静态博客 Hexo。于是开始在这个“自留地/实验室”里摆弄各种新玩意，做做小试验。没写过几篇文章，却也一直延续至今。</p>\n',createdAt:"2019-04-21T10:07:40.000Z",updatedAt:"2019-04-21T10:08:28.089Z",type:"post",permalink:"/blog/2019/04/recent-changes-of-my-site"},contentType:"markdown"},a=t.options.beforeCreate||[];t.options.beforeCreate=[function(){this.$page=e}].concat(a);var r=t.options.PageComponent;r&&(t.options.transition=r.transition),void 0===t.options.transition&&(t.options.transition=e.attributes.transition),t.options.name="page-wrapper-"+e.attributes.slug.replace(/[^0-9a-z\-]/i,"-")},o=Object(r.a)({},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("layout-manager",{attrs:{page:t.$page}},[a("h2",{attrs:{id:"old-days"}},[t._v("Old Days")]),t._v(" "),a("p",[t._v("我建博客始于 2013 年，时间也不长。那会儿也不过是一个从 WordPress 加免费空间入坑的新手，免费空间关了就买了个域名和虚拟空间继续折腾。啊对，也改成了 Typecho 一段时间，仿过几个主题。之后便是在流行之下，一个 "),a("a",{attrs:{href:"https://github.com/h404bi/www.h404bi.com/commit/88362f79adfea93151ecc9f19f8647cd28562c2c",target:"_blank",rel:"noopener noreferrer"}},[t._v("commit")]),t._v(" 换成了静态博客 Hexo。于是开始在这个“自留地/实验室”里摆弄各种新玩意，做做小试验。没写过几篇文章，却也一直延续至今。")]),t._v(" "),a("h2",{attrs:{id:"changes"}},[t._v("Changes")]),t._v(" "),a("p",[a("strong",[t._v("A. 核心系统")])]),t._v(" "),a("p",[t._v("将使用了近 4 年的 Hexo 换下是博客最近最大的改变，换上的是基于 Vue、Webpack 等当前主流技术的 "),a("a",{attrs:{href:"https://github.com/egoist/saber",target:"_blank",rel:"noopener noreferrer"}},[t._v("Saber")]),t._v(" 静态博客系统。")]),t._v(" "),a("figure",{attrs:{"data-type":"image"}},[a("img",{attrs:{src:"/static/img/loading.gif",alt:"","data-src":"/uploads/2019/04/20190421002.png"}})]),t._v(" "),a("p",[t._v("以 React、Vue、Webpack 等当代主流前端技术为基础的静态网站生成器系统持续出现并开始崭露头角，Gatsby、Nuxt、VuePress"),a("sup",{staticClass:"footnote-ref"},[a("a",{attrs:{href:"#fn1",id:"fnref1"}},[t._v("[1]")])]),t._v("，势必会抢占 Jekyll、Hexo 等以字符串模版为主的“更加静态"),a("sup",{staticClass:"footnote-ref"},[a("a",{attrs:{href:"#fn2",id:"fnref2"}},[t._v("[2]")])]),t._v("”的旧式静态博客系统，我相信这也是这个社群中的趋势。")]),t._v(" "),a("p",[t._v("在最初规划迭代的时候，预期是更换至 Gatsby 这个基于 React 技术栈的系统，其中的原因是受到 Daniel Eden（知名 CSS 动画框架 animate.css"),a("sup",{staticClass:"footnote-ref"},[a("a",{attrs:{href:"#fn3",id:"fnref3"}},[t._v("[3]")])]),t._v(" 的作者）的博客改版影响。他在稍早的一段时间将他的博客 —— "),a("a",{attrs:{href:"https://github.com/daneden/daneden.me",target:"_blank",rel:"noopener noreferrer"}},[t._v("daneden.me")]),t._v(" 从 Jekyll 换成了 Gatsby。我的博客受其影响很大，即使到目前为止，在我博客中你仍然能够找到一些来源于他的博客的设计元素。最明显的是在文章图文排版上的借鉴，在大屏幕下，你可以在如《"),a("saber-link",{attrs:{to:"/blog/2018/01/the-tao-of-notch-beyond-twitter"}},[t._v("推特背后的 Notch 之道")]),t._v("》等文章中看到左右溢出的插图。这个我非常喜欢的排版设计，便源于：「"),a("a",{attrs:{href:"https://daneden.me/2014/06/28/design-elitism/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Design Elitism")]),t._v("」，我博客的整个排版系统很大程度上受他影响，只是彼此经过多次迭代，已不太能找出相似点了。")],1),t._v(" "),a("figure",{attrs:{"data-type":"image"}},[a("img",{attrs:{src:"/static/img/loading.gif",alt:"Gatsby","data-src":"/uploads/2019/04/20190421005.png"}}),a("figcaption",[t._v("Gatsby")])]),t._v(" "),a("p",[t._v("没有选择 Gatsby 是因为在我对 React 生态的还不了解，头疼一连串硬啃 React、GraphQL\n等技术的时候，VuePress 出世了，我还是更倾向于相对比较熟悉的 Vue。")]),t._v(" "),a("figure",{staticClass:"right",attrs:{"data-type":"image"}},[a("img",{attrs:{src:"/static/img/loading.gif",alt:"VuePress","data-src":"/uploads/2019/04/20190421003.png"}}),a("figcaption",[t._v("VuePress")])]),t._v(" "),a("p",[t._v("然而，在我尝试 VuePress 后，其更加面向于项目文档的设计，让我感觉从 Hexo 迁移显得力不从心。对比 Gatsby 这或许是因为还是刚起步阶段，生态还不完善吧，截至目前其博客方面的支持还在陆续开发中"),a("sup",{staticClass:"footnote-ref"},[a("a",{attrs:{href:"#fn4",id:"fnref4"}},[t._v("[4]")])]),t._v("。")]),t._v(" "),a("p",[t._v("于是我便在等待/寻找一款能让我更加平滑地进行迁移的系统。然后 "),a("a",{attrs:{href:"https://github.com/upash/peco",target:"_blank",rel:"noopener noreferrer"}},[t._v("Peco")]),t._v(" 出现了，并在后来被现在的 "),a("a",{attrs:{href:"https://github.com/egoist/saber",target:"_blank",rel:"noopener noreferrer"}},[t._v("Saber")]),t._v(" 所替代。我不想在此大谈如何迁移至 Saber 的，真要这样或许会另起一篇文章写这个。只想说，非常感谢 EGOIST 的开源工作，让大家能够用上前沿的技术。")]),t._v(" "),a("p",[a("strong",[t._v("B. 主题外观")])]),t._v(" "),a("p",[t._v("得益于 Saber 的系统设计，将我的原有 Hexo 自用主题迁移至新系统并没有感觉到费力。迁移后整体上我还是使用此前的主题，只是在原有的基础上完成了一些更加细致的迭代，使其更符合我的现存观感。除了调整了列表的布局变得紧凑些、完善响应式文字排版设计外，最大的一点是从以前一直使用的 CSS 预处理器 Stylus 切换成了 SASS，并用上了原版 Bulma 框架。在生态上，果然还是 SASS 更胜一筹。")]),t._v(" "),a("figure",{attrs:{"data-type":"image"}},[a("img",{attrs:{src:"/static/img/loading.gif",alt:"Bulma.io","data-src":"/uploads/2019/04/20190421004.png"}}),a("figcaption",[a("a",{attrs:{href:"http://Bulma.io",target:"_blank",rel:"noopener noreferrer"}},[t._v("Bulma.io")])])]),t._v(" "),a("p",[t._v("期间学会了几个以前不了解、不常用的 CSS 属性，并应用到了主题中。")]),t._v(" "),a("ul",[a("li",[a("code",{pre:!0},[t._v("text-align: justify;")]),t._v(" —— 文字两端对齐，在单栏布局中排版差异尤为明显"),a("sup",{staticClass:"footnote-ref"},[a("a",{attrs:{href:"#fn5",id:"fnref5"}},[t._v("[5]")])])]),t._v(" "),a("li",[a("code",{pre:!0},[t._v("font-display: swap;")]),t._v(" —— 修改 Web 字体加载显示逻辑，可避免字体下载过程中闪白"),a("sup",{staticClass:"footnote-ref"},[a("a",{attrs:{href:"#fn6",id:"fnref6"}},[t._v("[6]")])])])]),t._v(" "),a("p",[t._v("不过整个主题目前还是有缺陷，只能后续随着时间推移再慢慢优化。")]),t._v(" "),a("p",[a("strong",[t._v("C. 部署架构")])]),t._v(" "),a("p",[t._v("在我刚开始使用 Hexo 或者说刚入坑静态博客系统的时候，我就已经在使用持续集成工具来帮助我进行构建和部署工作，一直在使用 "),a("a",{attrs:{href:"https://github.com/h404bi/www.h404bi.com/commits/master/.travis.yml",target:"_blank",rel:"noopener noreferrer"}},[t._v("Travis CI")]),t._v(" 的社区版。静态博客系统通过使用持续集成做自动构建部署，真的能省下不少重复劳动。")]),t._v(" "),a("figure",{attrs:{"data-type":"image"}},[a("img",{attrs:{src:"/static/img/loading.gif",alt:"旧部署架构","data-src":"/uploads/2019/04/20190421005.jpg"}}),a("figcaption",[t._v("旧部署架构")])]),t._v(" "),a("p",[t._v("旧架构如此的原因是以前部署到 GitHub Pages 上觉得速度不行，同时又不支持自定义域名使用 HTTPS，我也有一台闲置的香港 VPS，于是就通过 Webhook 触发 VPS 同步 GitHub Pages\n的内容，然后在 VPS 上使用 Nginx 提供服务，这样能解决前述的两个问题。后来因为域名的\nSSL 证书过期（那时还没用 Let's Encrypt）和 VPS 不稳定的原因，就加了层 CloudFlare。然后就没管了，一直这样。")]),t._v(" "),a("figure",{attrs:{"data-type":"image"}},[a("img",{attrs:{src:"/static/img/loading.gif",alt:"新部署架构","data-src":"/uploads/2019/04/20190421006.jpg"}}),a("figcaption",[t._v("新部署架构")])]),t._v(" "),a("p",[t._v("调整后实际上就是将提供服务的后端从 VPS 迁移到了 "),a("a",{attrs:{href:"https://www.netlify.com",target:"_blank",rel:"noopener noreferrer"}},[t._v("Netlify")]),t._v("。其一是图方便，Netlify\n自动申请 Let's Encrypt 不用自己麻烦在 VPS 上设置，其二是 Netlify 自带 CDN，速度还不错，最后是因为我需要调整整个博客各页面的固定链接，同时希望旧有的链接能重定向到新的固定链接上，保留可用性。而刚好 Netlify 原生支持重定向服务 —— "),a("a",{attrs:{href:"https://www.netlify.com/docs/redirects/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Netlify Redirect")]),t._v("，这样就不用因为 CloudFlare 免费版只有 3 个 Page Rules 而显得拘谨。")]),t._v(" "),a("p",[t._v("构建文件依然推送到 GitHub Pages 分支上后再同步到 Netlify 的原因是，我希望保留能够在 GitHub 仓库中查看构建后的文件的功能，构建后直接推送到 Netlify 上我就看不到构建文件和历史变更了。")]),t._v(" "),a("figure",{attrs:{"data-type":"image"}},[a("img",{attrs:{src:"/static/img/loading.gif",alt:"Wappalyzer 检查","data-src":"/uploads/2019/04/20190421007.png"}}),a("figcaption",[t._v("Wappalyzer 检查")])]),t._v(" "),a("p",[t._v("故意加了个假的 Hexo Generator 的 Meta 标签，所以被检测出用 Hexo（大雾）。关于这个扩展程序，可以看我之前写的文章《"),a("saber-link",{attrs:{to:"/blog/2018/12/chrome-extensions-that-i-am-using"}},[t._v("我都在用些什么 Chrome 扩展程序")]),t._v("》里有介绍。")],1),t._v(" "),a("p",[a("strong",[t._v("D. 其它变化")])]),t._v(" "),a("p",[t._v("整个核心架构变化，于是现在托管仓库的项目架构也有所调整，改成了 Monorepo 并用 Lerna\n进行管理"),a("sup",{staticClass:"footnote-ref"},[a("a",{attrs:{href:"#fn7",id:"fnref7"}},[t._v("[7]")])]),t._v("。")]),t._v(" "),a("p",[t._v("修改了内容授权协议，具体可见 About 页面。因为细想了一下，真有人取走内容的话大概也不会在意你的协议，于是干脆放飞自我。")]),t._v(" "),a("p",[t._v("完整的迁移记录可见仓库 "),a("a",{attrs:{href:"https://github.com/h404bi/www.h404bi.com/compare/v2019.3.29-mina...592c99",target:"_blank",rel:"noopener noreferrer"}},[t._v("Commit Log")]),t._v("。")]),t._v(" "),a("hr",{staticClass:"footnotes-sep"}),t._v(" "),a("section",{staticClass:"footnotes"},[a("ol",{staticClass:"footnotes-list"},[a("li",{staticClass:"footnote-item",attrs:{id:"fn1"}},[a("p",[a("a",{attrs:{href:"https://www.staticgen.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://www.staticgen.com/")]),t._v(" "),a("a",{staticClass:"footnote-backref",attrs:{href:"#fnref1"}},[t._v("↩︎")])])]),t._v(" "),a("li",{staticClass:"footnote-item",attrs:{id:"fn2"}},[a("p",[a("a",{attrs:{href:"https://vuepress.vuejs.org/zh/guide/#hexo",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://vuepress.vuejs.org/zh/guide/#hexo")]),t._v(" "),a("a",{staticClass:"footnote-backref",attrs:{href:"#fnref2"}},[t._v("↩︎")])])]),t._v(" "),a("li",{staticClass:"footnote-item",attrs:{id:"fn3"}},[a("p",[a("a",{attrs:{href:"https://daneden.github.io/animate.css/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://daneden.github.io/animate.css/")]),t._v(" "),a("a",{staticClass:"footnote-backref",attrs:{href:"#fnref3"}},[t._v("↩︎")])])]),t._v(" "),a("li",{staticClass:"footnote-item",attrs:{id:"fn4"}},[a("p",[a("a",{attrs:{href:"https://github.com/vuejs/vuepress/issues/36",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/vuejs/vuepress/issues/36")]),t._v(" "),a("a",{staticClass:"footnote-backref",attrs:{href:"#fnref4"}},[t._v("↩︎")])])]),t._v(" "),a("li",{staticClass:"footnote-item",attrs:{id:"fn5"}},[a("p",[a("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/CSS/text-align#Justify",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://developer.mozilla.org/zh-CN/docs/Web/CSS/text-align#Justify")]),t._v(" "),a("a",{staticClass:"footnote-backref",attrs:{href:"#fnref5"}},[t._v("↩︎")])])]),t._v(" "),a("li",{staticClass:"footnote-item",attrs:{id:"fn6"}},[a("p",[a("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/CSS/@font-face/font-display",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://developer.mozilla.org/zh-CN/docs/Web/CSS/@font-face/font-display")]),t._v(" "),a("a",{staticClass:"footnote-backref",attrs:{href:"#fnref6"}},[t._v("↩︎")])])]),t._v(" "),a("li",{staticClass:"footnote-item",attrs:{id:"fn7"}},[a("p",[a("a",{attrs:{href:"https://github.com/h404bi/www.h404bi.com/tree/592c99120e8452a816d51fbec6fb7eabf3f15448",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/h404bi/www.h404bi.com/tree/592c99120e8452a816d51fbec6fb7eabf3f15448")]),t._v(" "),a("a",{staticClass:"footnote-backref",attrs:{href:"#fnref7"}},[t._v("↩︎")])])])])])])},[],!1,null,null,null);"function"==typeof s&&s(o);e.default=o.exports}}]);